(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/expert/expertInfo"],{219:function(e,t,n){"use strict";(function(e){n(5);o(n(3));var t=o(n(220));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n(1)["createPage"])},220:function(e,t,n){"use strict";n.r(t);var o=n(221),i=n(223);for(var s in i)"default"!==s&&function(e){n.d(t,e,(function(){return i[e]}))}(s);n(225),n(227);var a,r=n(26),c=Object(r["default"])(i["default"],o["render"],o["staticRenderFns"],!1,null,"3f76c554",null,!1,o["components"],a);c.options.__file="pages/expert/expertInfo.vue",t["default"]=c.exports},221:function(e,t,n){"use strict";n.r(t);var o=n(222);n.d(t,"render",(function(){return o["render"]})),n.d(t,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(t,"components",(function(){return o["components"]}))},222:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"render",(function(){return i})),n.d(t,"staticRenderFns",(function(){return a})),n.d(t,"recyclableRender",(function(){return s})),n.d(t,"components",(function(){return o}));var i=function(){var e=this,t=e.$createElement;e._self._c},s=!1,a=[];i._withStripped=!0},223:function(e,t,n){"use strict";n.r(t);var o=n(224),i=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t["default"]=i.a},224:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(n(9)),o(n(13));function o(e){return e&&e.__esModule?e:{default:e}}var i={data:function(){return{bodyShow:!0,calendarInfo:{},calendarListInfo:{},parentOpenid:"",openid:"",localtionPlatform:"",defaultCover:"../../static/man.png",exitCalenAvatar:"",longDistanceTrainList:[]}},onLoad:function(e){e.id&&(this.id=e.id),this.loadData()},methods:{loadData:function(){var t=this;this.id&&""!=this.id?(e.showLoading({title:"数据加载中"}),this.$apis.postCalendarDetail({id:this.id}).then((function(n){e.hideLoading(),200==n.code?t.calendarInfo=n.result:e.showToast({title:n.msg})})).catch((function(t){e.hideLoading(),console.log(t)})),this.$apis.postListCalendarInfo({expertId:this.id}).then((function(n){e.hideLoading(),200==n.code?(console.log("获取专家日历成功"),t.calendarListInfo=n.result):e.showToast({title:n.msg})})).catch((function(t){e.hideLoading(),console.log(t)})),this.$apis.postLongDistanceTrainList({expertId:this.id}).then((function(n){200==n.code?t.longDistanceTrainList=n.result:e.showToast({title:n.msg})}))):e.showToast({title:"专家信息为空！"})},imageError:function(){this.calendarInfo.avatar=this.defaultCover},orderExpert:function(t,n,o,i,s,a){var r=this;console.log("日历id："+t);var c=e.getStorageSync("userData");this.$apis.postOrderExpert({id:t}).then((function(u){if(200==u.code){var l=[],d={expertId:r.id,userId:c.userId,calendarId:t,patientName:c.userName,patientSex:c.sex,patientAge:c.age,type:"2",status:"1"};l.push(d),r.$apis.postSaveOoderInfo(l).then((function(t){200==t.code?(console.log("保存预约人信息成功"),r.requestSubscribeMessage(n,o,i,s,t.id,a),r.toConsultationDetail(t.id)):e.showToast({title:t.msg}),r.$apis.postSendAppointSuccessMsg({expertName:s,expertPhone:a}).then((function(t){200==t.code?console.log("给专家发送短信提醒成功"):e.showToast({title:t.msg})})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}else e.showToast({title:u.msg})})).catch((function(e){console.log(e)})),this.loadData(),wx.showToast({title:"预约成功",icon:"success",duration:1e3})},toConsultationDetail:function(t){e.navigateTo({url:"/pages/expert/consultationDetail?id="+t})},requestSubscribeMessage:function(t,n,o,i,s,a){e.requestSubscribeMessage({tmplIds:["4IVeiK2tYEmXqTcDJ7IVnXduD2CToUiV9Sz7ZHCObfs"],success:function(e){console.log("调起成功"),"accept"===e[tempId[0]]&&console.log("允许"),"reject"===e[tempId[0]]&&console.log("拒绝")},fail:function(e){20004==e.errCode?console.log("关闭小程序主开关"):console.log("订阅失败")}});var r=e.getStorageSync("userData"),c={touser:r.openid,visitDate:t,beginTime:n,endTime:o,expertName:i,consulId:s,mobilePhone:a,userId:r.userId};this.$apis.postsendMessage(c).then((function(e){0==e.errcode?console.log("模板消息推送成功"):console.log("模板消息推送失败")})).catch((function(e){console.log(e)}))}}};t.default=i}).call(this,n(1)["default"])},225:function(e,t,n){"use strict";n.r(t);var o=n(226),i=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t["default"]=i.a},226:function(e,t,n){},227:function(e,t,n){"use strict";n.r(t);var o=n(228),i=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t["default"]=i.a},228:function(e,t,n){}},[[219,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/expert/expertInfo.js.map