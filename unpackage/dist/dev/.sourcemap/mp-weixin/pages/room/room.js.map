{"version":3,"sources":["uni-app:///main.js","webpack:////Users/bytedance/Documents/HBuilderProjects/review_wx_applets/pages/room/room.vue?5837","webpack:////Users/bytedance/Documents/HBuilderProjects/review_wx_applets/pages/room/room.vue?d750","webpack:////Users/bytedance/Documents/HBuilderProjects/review_wx_applets/pages/room/room.vue?3f19","webpack:////Users/bytedance/Documents/HBuilderProjects/review_wx_applets/pages/room/room.vue?19d2","uni-app:///pages/room/room.vue","webpack:////Users/bytedance/Documents/HBuilderProjects/review_wx_applets/pages/room/room.vue?d542","webpack:////Users/bytedance/Documents/HBuilderProjects/review_wx_applets/pages/room/room.vue?a477"],"names":["createPage","Page"],"mappings":"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","file":"pages/room/room.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/room/room.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./room.vue?vue&type=template&id=3308d434&\"\nvar renderjs\nimport script from \"./room.vue?vue&type=script&lang=js&\"\nexport * from \"./room.vue?vue&type=script&lang=js&\"\nimport style0 from \"./room.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/room/room.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=template&id=3308d434&\"","var components\ntry {\n  components = {\n    trtcRoom: function() {\n      return import(\n        /* webpackChunkName: \"components/trtc-room/trtc-room\" */ \"@/components/trtc-room/trtc-room.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=script&lang=js&\"","<template>\r\n<!--miniprogram/pages/room/room.wxml-->\r\n<!-- 在模版上放置标签 -->\r\n<view class=\"page-room\">\r\n  <trtc-room ref=\"trtc-component\" :config=\"rtcConfig\"> </trtc-room>\r\n  <view class=\"tip-toast\" v-if=\"showTipToast\">\r\n    <view>当前房间为1v1双人通话房间</view>\r\n    <view>不希望其他人打扰</view>\r\n  </view>\r\n</view>\r\n</template>\r\n\r\n<script>\r\nimport { genTestUserSig } from \"../../debug/GenerateTestUserSig\";\r\nimport trtcRoom from \"../../components/trtc-room/trtc-room\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      rtcConfig: {\r\n        sdkAppID: '1400584863',\r\n        // 必要参数 开通实时音视频服务创建应用后分配的 sdkAppID\r\n        userID: 'oE_EL5jr7oiD2sbr90bvxXd5e2zo',\r\n        // 必要参数 用户 ID 可以由您的帐号系统指定\r\n        userSig: '',\r\n        // 必要参数 身份签名，相当于登录密码的作用\r\n        template: '1v1' // 必要参数 组件模版，支持的值 1v1 grid custom ，注意：不支持动态修改, iOS 不支持 pusher 动态渲染\r\n\r\n      },\r\n      showTipToast: false,\r\n      subscribeList: {}\r\n    };\r\n  },\r\n\r\n  components: {\r\n    trtcRoom\r\n  },\r\n  props: {},\r\n\r\n  /**\r\n   * 生命周期函数--监听页面加载\r\n   * @param {*} options 配置项\r\n   */\r\n  onLoad: function (options) {\r\n    console.log('room onload', options);\r\n    uni.setKeepScreenOn({\r\n      keepScreenOn: true\r\n    }); // 获取 rtcroom 实例\r\n\r\n    this.trtcComponent = this.$refs['trtc-component']; // 监听TRTC Room 关键事件\r\n\r\n    this.bindTRTCRoomEvent(); // 将String 类型的 true false 转换成 boolean\r\n\r\n    Object.getOwnPropertyNames(options).forEach(key => {\r\n      if (options[key] === 'true') {\r\n        options[key] = true;\r\n      }\r\n\r\n      if (options[key] === 'false') {\r\n        options[key] = false;\r\n      }\r\n    });\r\n    this.options = options; // querystring 只支持传递 String 类型, 注意类型转换\r\n\r\n    this.enterRoom({\r\n      roomID: Number(options.roomID),\r\n      userID: options.userID,\r\n      template: options.template,\r\n      debugMode: options.debugMode,\r\n      frontCamera: options.frontCamera,\r\n      localVideo: options.localVideo,\r\n      localAudio: options.localAudio,\r\n      enableEarMonitor: options.enableEarMonitor,\r\n      enableAutoFocus: options.enableAutoFocus,\r\n      localMirror: options.localMirror,\r\n      enableAgc: options.enableAgc,\r\n      enableAns: options.enableAns,\r\n      videoHeight: options.videoHeight,\r\n      videoWidth: options.videoWidth,\r\n      maxBitrate: Number(options.maxBitrate),\r\n      minBitrate: Number(options.minBitrate),\r\n      audioVolumeType: options.audioVolumeType,\r\n      audioQuality: options.audioQuality,\r\n      // pusher URL 参数\r\n      scene: options.scene,\r\n      encsmall: options.encsmall,\r\n      cloudenv: options.cloudenv,\r\n      enableBlackStream: options.enableBlackStream,\r\n      streamID: options.streamID,\r\n      userDefineRecordID: options.userDefineRecordID,\r\n      privateMapKey: options.privateMapKey,\r\n      pureAudioMode: options.pureAudioMode,\r\n      recvMode: options.recvMode,\r\n      // player 参数\r\n      enableRecvMessage: options.enableRecvMessage\r\n    });\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面初次渲染完成\r\n   */\r\n  onReady: function () {\r\n    console.log('room ready');\r\n    uni.setKeepScreenOn({\r\n      keepScreenOn: true\r\n    });\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面显示\r\n   */\r\n  onShow: function () {\r\n    console.log('room show');\r\n    uni.setKeepScreenOn({\r\n      keepScreenOn: true\r\n    });\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面隐藏\r\n   */\r\n  onHide: function () {\r\n    console.log('room hide'); // onHide 后由微信接管，限制了不能退房，只能取消订阅\r\n    // 退后台后取消发布音频\r\n    // this.trtcComponent.unpublishLocalAudio()\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面卸载\r\n   */\r\n  onUnload: function () {\r\n    console.log('room unload');\r\n    uni.setKeepScreenOn({\r\n      keepScreenOn: false\r\n    });\r\n  },\r\n\r\n  /**\r\n   * 页面相关事件处理函数--监听用户下拉动作\r\n   */\r\n  onPullDownRefresh: function () {},\r\n\r\n  /**\r\n   * 页面上拉触底事件的处理函数\r\n   */\r\n  onReachBottom: function () {},\r\n\r\n  /**\r\n   * 用户点击右上角分享\r\n   */\r\n  onShareAppMessage: function () {},\r\n  methods: {\r\n    enterRoom: function (params) {\r\n      params.template = params.template || '1v1';\r\n      params.roomID = params.roomID || this.randomRoomID();\r\n      params.userID = params.userID || this.randomUserID();\r\n      console.log('* room enterRoom', params);\r\n      const Signature = genTestUserSig(params.userID);\r\n      params.sdkAppID = Signature.sdkAppID;\r\n      params.userSig = Signature.userSig;\r\n      this.template = params.template;\r\n\r\n      if (params.template === 'grid') {\r\n        this.rtcConfig = {\r\n          sdkAppID: params.sdkAppID,\r\n          // 您的实时音视频服务创建应用后分配的 sdkAppID\r\n          userID: params.userID,\r\n          userSig: params.userSig,\r\n          template: params.template,\r\n          // 1v1 grid custom\r\n          debugMode: params.debugMode,\r\n          // 非必要参数，打开组件的调试模式，开发调试时建议设置为 true\r\n          frontCamera: params.frontCamera,\r\n          enableEarMonitor: params.enableEarMonitor,\r\n          enableAutoFocus: params.enableAutoFocus,\r\n          localMirror: params.localMirror,\r\n          enableAgc: params.enableAgc,\r\n          enableAns: params.enableAns,\r\n          videoWidth: params.videoWidth,\r\n          videoHeight: params.videoHeight,\r\n          maxBitrate: params.maxBitrate,\r\n          minBitrate: params.minBitrate,\r\n          beautyLevel: 9,\r\n          // 开启美颜等级 0～9级美颜\r\n          enableIM: false,\r\n          // 可选，仅支持初始化设置（进房前设置），不支持动态修改\r\n          audioVolumeType: params.audioVolumeType,\r\n          audioQuality: params.audioQuality,\r\n          // pusher URL 参数\r\n          scene: params.scene,\r\n          // rtc live\r\n          encsmall: params.encsmall ? 1 : 0,\r\n          cloudenv: params.cloudenv,\r\n          enableBlackStream: params.enableBlackStream,\r\n          streamID: params.streamID,\r\n          userDefineRecordID: params.userDefineRecordID,\r\n          privateMapKey: params.privateMapKey,\r\n          pureAudioMode: params.pureAudioMode,\r\n          recvMode: params.recvMode\r\n        };\r\n      } else {\r\n        this.rtcConfig = {\r\n          sdkAppID: params.sdkAppID,\r\n          // 您的实时音视频服务创建应用后分配的 sdkAppID\r\n          userID: params.userID,\r\n          userSig: params.userSig,\r\n          template: params.template,\r\n          // 1v1 grid custom\r\n          debugMode: params.debugMode,\r\n          // 非必要参数，打开组件的调试模式，开发调试时建议设置为 true\r\n          beautyLevel: 9,\r\n          // 默认开启美颜\r\n          enableIM: false,\r\n          // 可选，仅支持初始化设置（进房前设置），不支持动态修改\r\n          audioVolumeType: params.audioVolumeType\r\n        };\r\n      }\r\n\r\n      this.setData({\r\n        rtcConfig: this.rtcConfig\r\n      }, () => {\r\n        // roomID 取值范围 1 ~ 4294967295\r\n        this.trtcComponent.enterRoom({\r\n          roomID: params.roomID\r\n        }).then(() => {\r\n          if (this.template === 'custom') {\r\n            // 设置推流端视窗的坐标和尺寸\r\n            this.trtcComponent.setViewRect({\r\n              userID: params.userID,\r\n              xAxis: '480rpx',\r\n              yAxis: '160rpx',\r\n              width: '240rpx',\r\n              height: '320rpx'\r\n            });\r\n          }\r\n        }).catch(res => {\r\n          console.error('* room joinRoom 进房失败:', res);\r\n        });\r\n      });\r\n    },\r\n    bindTRTCRoomEvent: function () {\r\n      const TRTC_EVENT = this.trtcComponent.EVENT;\r\n      this.timestamp = []; // 初始化事件订阅\r\n\r\n      this.trtcComponent.on(TRTC_EVENT.LOCAL_JOIN, event => {\r\n        console.log('* room LOCAL_JOIN', event); // 进房成功，触发该事件后可以对本地视频和音频进行设置\r\n\r\n        if (this.options.localVideo === true || this.options.template === '1v1') {\r\n          this.trtcComponent.publishLocalVideo();\r\n        }\r\n\r\n        if (this.options.localAudio === true || this.options.template === '1v1') {\r\n          this.trtcComponent.publishLocalAudio();\r\n        }\r\n\r\n        if (this.options.template === 'custom') {\r\n          this.trtcComponent.setViewRect({\r\n            userID: event.userID,\r\n            xAxis: '0rpx',\r\n            yAxis: '0rpx',\r\n            width: '240rpx',\r\n            height: '320rpx'\r\n          });\r\n        }\r\n      });\r\n      this.trtcComponent.on(TRTC_EVENT.LOCAL_LEAVE, event => {\r\n        console.log('* room LOCAL_LEAVE', event);\r\n      });\r\n      this.trtcComponent.on(TRTC_EVENT.ERROR, event => {\r\n        console.log('* room ERROR', event);\r\n      }); // 远端用户进房\r\n\r\n      this.trtcComponent.on(TRTC_EVENT.REMOTE_USER_JOIN, event => {\r\n        console.log('* room REMOTE_USER_JOIN', event, this.trtcComponent.getRemoteUserList());\r\n        this.timestamp.push(new Date()); // 1v1视频通话时限制人数为两人的简易逻辑，建议通过后端实现房间人数管理\r\n        // 2人以上同时进行通话请选择网格布局\r\n\r\n        if (this.template === '1v1' && this.timestamp.length > 1) {\r\n          const interval = this.timestamp[1] - this.timestamp[0];\r\n\r\n          if (interval < 1000) {\r\n            // 房间里已经有两个人\r\n            this.setData({\r\n              showTipToast: true\r\n            }, () => {\r\n              setTimeout(() => {\r\n                this.setData({\r\n                  showTipToast: false\r\n                });\r\n                uni.navigateBack({\r\n                  delta: 1\r\n                });\r\n              }, 4000);\r\n            });\r\n          }\r\n        }\r\n      }); // 远端用户退出\r\n\r\n      this.trtcComponent.on(TRTC_EVENT.REMOTE_USER_LEAVE, event => {\r\n        console.log('* room REMOTE_USER_LEAVE', event, this.trtcComponent.getRemoteUserList());\r\n\r\n        if (this.template === '1v1') {\r\n          this.timestamp = [];\r\n        }\r\n\r\n        if (this.template === '1v1' && this.remoteUser === event.data.userID) {\r\n          this.remoteUser = null;\r\n        }\r\n      }); // 远端用户推送视频\r\n\r\n      this.trtcComponent.on(TRTC_EVENT.REMOTE_VIDEO_ADD, event => {\r\n        console.log('* room REMOTE_VIDEO_ADD', event, this.trtcComponent.getRemoteUserList()); // 订阅视频\r\n\r\n        const userList = this.trtcComponent.getRemoteUserList();\r\n        const data = event.data;\r\n\r\n        if (this.template === '1v1' && (!this.remoteUser || this.remoteUser === data.userID)) {\r\n          // 1v1 只订阅第一个远端流\r\n          this.remoteUser = data.userID;\r\n          this.trtcComponent.subscribeRemoteVideo({\r\n            userID: data.userID,\r\n            streamType: data.streamType\r\n          });\r\n        } else {\r\n          // if (!this.data.subscribeList[data.userID + '-video']) {\r\n          this.trtcComponent.subscribeRemoteVideo({\r\n            userID: data.userID,\r\n            streamType: data.streamType\r\n          }); // 标记该用户已首次订阅过\r\n\r\n          this.subscribeList[data.userID + '-video'] = true; // }\r\n        }\r\n\r\n        if (this.template === 'custom' && data.userID && data.streamType) {\r\n          let index = userList.findIndex(item => {\r\n            return item.userID === data.userID;\r\n          });\r\n          index++;\r\n          const y = 320 * index + 160; // 设置远端视图坐标和尺寸\r\n\r\n          this.trtcComponent.setViewRect({\r\n            userID: data.userID,\r\n            streamType: data.streamType,\r\n            xAxis: '480rpx',\r\n            yAxis: y + 'rpx',\r\n            width: '240rpx',\r\n            height: '320rpx'\r\n          });\r\n        }\r\n      }); // 远端用户取消推送视频\r\n\r\n      this.trtcComponent.on(TRTC_EVENT.REMOTE_VIDEO_REMOVE, event => {\r\n        console.log('* room REMOTE_VIDEO_REMOVE', event, this.trtcComponent.getRemoteUserList());\r\n      }); // 远端用户推送音频\r\n\r\n      this.trtcComponent.on(TRTC_EVENT.REMOTE_AUDIO_ADD, event => {\r\n        console.log('* room REMOTE_AUDIO_ADD', event, this.trtcComponent.getRemoteUserList()); // 订阅音频\r\n\r\n        const data = event.data;\r\n\r\n        if (this.template === '1v1' && (!this.remoteUser || this.remoteUser === data.userID)) {\r\n          this.remoteUser = data.userID;\r\n          this.trtcComponent.subscribeRemoteAudio({\r\n            userID: data.userID\r\n          });\r\n        } else {\r\n          // if (!this.data.subscribeList[data.userID + '-audio']) {\r\n          this.trtcComponent.subscribeRemoteAudio({\r\n            userID: data.userID\r\n          }); // 标记该用户已首次订阅过\r\n\r\n          this.subscribeList[data.userID + '-audio'] = true; // }\r\n        }\r\n      }); // 远端用户取消推送音频\r\n\r\n      this.trtcComponent.on(TRTC_EVENT.REMOTE_AUDIO_REMOVE, event => {\r\n        console.log('* room REMOTE_AUDIO_REMOVE', event, this.trtcComponent.getRemoteUserList());\r\n      }); // this.trtcComponent.on(TRTC_EVENT.LOCAL_NET_STATE_UPDATE, (event)=>{\r\n      //   console.log('* room LOCAL_NET_STATE_UPDATE', event)\r\n      // })\r\n      // this.trtcComponent.on(TRTC_EVENT.REMOTE_NET_STATE_UPDATE, (event)=>{\r\n      //   console.log('* room REMOTE_NET_STATE_UPDATE', event)\r\n      // })\r\n\r\n      this.trtcComponent.on(TRTC_EVENT.IM_READY, event => {\r\n        console.log('* room IM_READY', event);\r\n      });\r\n      this.trtcComponent.on(TRTC_EVENT.IM_MESSAGE_RECEIVED, event => {\r\n        console.log('* room IM_MESSAGE_RECEIVED', event);\r\n      });\r\n    },\r\n    randomUserID: function () {\r\n      return new Date().getTime().toString(16).split('').reverse().join('');\r\n    },\r\n    randomRoomID: function () {\r\n      return parseInt(Math.random() * 9999);\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style>\r\n/* miniprogram/pages/room/room.wxss */\r\n.page-room{\r\n  width: 100vw;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n}\r\n.tip-toast {\r\n  position: absolute;\r\n  top: 40vh;\r\n  width: 70vw;\r\n  left: 15vw;\r\n  border-radius: 12rpx;\r\n  height: 20vh;\r\n  background: rgba(0,0,0,0.8);\r\n  color: white;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n\r\n}\r\n.tip-toast view {\r\n  padding: 20rpx 0;\r\n  font-size: 32rpx;\r\n}\r\n</style>","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1634546975594\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}